---
title: "Error simulation"
author: "Wael"
date: "02/05/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
source("plot_error_algo3.R")
```

```{r}
#Numerical comparison between algo2 and algo 3 using the first generation
# w.r.t. to the number of indiviuals (=n)
k <- c(3,3,3)
M <- 3
L <- c(10,10,10)
N <- c(60,90,120,150,180,210, 240, 270, 300)
efn <- rep(0, length(N))
efl <- rep(0, length(N))
ind <- 0
for(i in N){
  ind <- ind + 1
  n <- rep(i, 5)
  e <- c(0,0)
  for(j in n){
    e <- error_algo3(j,k,L, M) + e
  }
  e <- (1/5)*e
  efn[ind] <- e[1]
  efl[ind] <- e[2]
  
}
g <- ggplot(data = NULL,aes(x=N))
g <- g +geom_line(aes(y = efn), coulour = "red")
g <- g  + geom_line(aes(y = efl), colour = "green")
g
```
```{r}
#Numerical comparison between algo2 and algo 3 using the second generation
# w.r.t. to the number of indiviuals (=n)
k <- c(3,3,3)
M <- 3
L <- 40
N <- c(60,90, 120, 150)
efn <- rep(0, length(N))
efl <- rep(0, length(N))
ind <- 0
for(i in N){
  ind <- ind + 1
  n <- rep(i, 2)
  e <- c(0,0)
  for(j in n){
    e <- error_algo3_new(j,k,L, M) + e
  }
  e <- (1/2)*e
  efn[ind] <- e[1]
  efl[ind] <- e[2]
  
}
g <- ggplot(data = NULL,aes(x=N))
g <- g +geom_line(aes(y = efn), coulour = "red")
g <- g  + geom_line(aes(y = efl), colour = "green")
g
```





```{r}
#Numerical comparison of the three algorithms
# So, we consider M=1 to include the first algorithm
#1. w.r.t. to the number of individuals
k <- 2
M <- 1
L <- 3
N <- c(60,70,80,90,100)
efn <- rep(0, length(N))
efl <- rep(0, length(N))
ind <- 0
for(i in N){
  ind <- ind + 1
  n <- rep(i, 10)
  e <- c(0,0)
  for(j in n){
    e <- error_algo3(j,k,L, M) + e
  }
  e <- 1/10*e
  efn[ind] <- e[1]
  efl[ind] <- e[2]
  
}

```




