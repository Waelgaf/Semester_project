---
title: "Error simulation"
author: "Wael"
date: "02/05/2023"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
source("Algo1.R")
source("Algo2.R")
source("Algo3.R")
source("Generation_network.R")
source("global_error.R")
source("error_measures.R")
library(ggplot2)


```






```{r}
#Numerical comparison of algorithm 2 and 3

#We vary N
L <- 40
K <- 3
M <- 3
ro <- 0.7
a <- 0.5
N <- c(60, 90, 120, 150, 180, 210, 240, 270)
er_2l <- rep(0, length(N))
er_3l <- rep(0, length(N))
er_2n <- rep(0, length(N))
er_3n <- rep(0, length(N))

j <- 0  
for(n in N){
  j <- j+1
  e <- rep(0,4)
  nl <- rep(n,5)
  for(i in nl){
    e <- error_12(n, K, L, M, ro, a) + e
  }
  er_2l[j] <- e[1]/5
  er_3l[j] <- e[2]/5
  er_2n[j] <- e[3]/5
  er_3n[j] <- e[4]/5
}
gnN <- ggplot(data = NULL,aes(x=N))
gnN <- gnN + geom_line(aes(y=er_2n), colour = "green")
gnN <- gnN + geom_line(aes(y=er_3n), colour = "blue")

glN <- ggplot(data = NULL,aes(x=N))
glN <- glN + geom_line(aes(y=er_2l), colour = "green")
glN <- glN + geom_line(aes(y=er_3l), colour = "blue")

gnN + ggtitle("Missclassification rate vs N (within layers)")
glN + ggtitle("Missclassification rate vs N (between layers)")



```
```{r}
#Numerical comparison of algorithm 2 and 3
#We vary M
L <- 40
K <- 3
ro <- 0.7
a <- 0.5
N <- 150
M <- c(2,3,4,5,6)
er_2l <- rep(0, length(M))
er_3l <- rep(0, length(M))
er_2n <- rep(0, length(M))
er_3n <- rep(0, length(M))

j <- 0  
for(m in M){
  j <- j+1
  e <- rep(0,4)
  ml <- rep(m,5)
  for(i in nl){
    e <- error_12(N, K, L, ml, ro, a) + e
  }
  er_2l[j] <- e[1]/5
  er_3l[j] <- e[2]/5
  er_2n[j] <- e[3]/5
  er_3n[j] <- e[4]/5
}
gnM <- ggplot(data = NULL,aes(x=M))
gnM <- gnM + geom_line(aes(y=er_2n), colour = "green")
gnM <- gnM + geom_line(aes(y=er_3n), colour = "blue")

glM <- ggplot(data = NULL,aes(x=M))
glM <- glM + geom_line(aes(y=er_2l), colour = "green")
glM <- glM + geom_line(aes(y=er_3l), colour = "blue")

gnM + ggtitle("Missclassification rate vs N (within layers)")
glM + ggtitle("Missclassification rate vs N (between layers)")



```


```{r}
#Numerical comparison of algorithm 1, 2 and 3
# So, we consider M=1 to include the first algorithm

#We vary N
L <- c(4,4)
K <- 3
ro <- 0.7
a <- 0.5
N <- c(60, 90, 120, 150, 180)
er_1n <- rep(0, length(N))
er_2n <- rep(0, length(N))
er_3n <- rep(0, length(N))

j <- 0  
for(n in N){
  j <- j+1
  e <- rep(0,3)
  nl <- rep(n,5)
  for(i in nl){
    e <- error_123(n, K, L, ro, a) + e
  }
  er_1n[j] <- e[1]/5
  er_2n[j] <- e[2]/5
  er_3n[j] <- e[3]/5
}
gn <- ggplot(data = NULL,aes(x=N))
gn <- gn + geom_line(aes(y=er_1n), colour = "red")
gn<- gn + geom_line(aes(y=er_2n), colour = "green")
gn<- gn + geom_line(aes(y=er_3n), colour = "blue")



gn + ggtitle("Missclassification rate vs N (between layers)")




```




